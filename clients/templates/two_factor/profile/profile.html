{% extends "two_factor/_base.html" %}
{% load static %}
{% load i18n %}
{% block content %}

{% include "dashboard/sideheader/side.html" %}


<!-- [ Main Content ] start -->
<div class="pcoded-main-container">
	<div class="pcoded-content">
		<!-- [ breadcrumb ] start -->
		<div class="page-header">
			<div class="page-block">
				<div class="row align-items-center">
					<div class="col-md-12">
						<div class="page-header-title">
							<h5 class="m-b-10">Security</h5>
						</div>
						<ul class="breadcrumb">
							<li class="breadcrumb-item"><a href="index.html"><i class="feather icon-home"></i></a></li>
							<li class="breadcrumb-item"><a href="#!">Two Factor Authentication</a></li>
							<li class="breadcrumb-item"><a href="#!">Profile</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

     <!-- [ horizontal-layout ] start -->
     <div class="col-sm-12">
      <div class="card">
          <div class="card-header">
            <h1>{% block title %}{% trans "Account Security" %}{% endblock %}</h1>

              <div class="card-header-right">
                  <div class="btn-group card-option">
                      <button type="button" class="btn dropdown-toggle btn-icon" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <i class="feather icon-more-horizontal"></i>
                      </button>
                      <ul class="list-unstyled card-option dropdown-menu dropdown-menu-right">
                          <li class="dropdown-item full-card"><a href="#!"><span><i class="feather icon-maximize"></i> maximize</span><span style="display:none"><i class="feather icon-minimize"></i> Restore</span></a>
                          </li>
                          <li class="dropdown-item minimize-card"><a href="#!"><span><i class="feather icon-minus"></i> collapse</span><span style="display:none"><i class="feather icon-plus"></i> expand</span></a></li>
                          <li class="dropdown-item reload-card"><a href="#!"><i class="feather icon-refresh-cw"></i> reload</a></li>
                          <li class="dropdown-item close-card"><a href="#!"><i class="feather icon-trash"></i> remove</a></li>
                      </ul>
                  </div>
              </div>
          </div>
          <div class="card-body">
            
        
              {% if default_device %}
              {% if default_device_type == 'TOTPDevice' %}
                <p>{% trans "Tokens will be generated by your token generator." %}</p>
              {% elif default_device_type == 'PhoneDevice' %}
                <p>{% blocktrans with primary=default_device.generate_challenge_button_title %}Primary method: {{ primary }}{% endblocktrans %}</p>
              {% elif default_device_type == 'RemoteYubikeyDevice' %}
                <p>{% blocktrans %}Tokens will be generated by your YubiKey.{% endblocktrans %}</p>
              {% endif %}
          
              {% if available_phone_methods %}
                <h2>{% trans "Backup Phone Numbers" %}</h2>
                <p>{% blocktrans trimmed %}If your primary method is not available, we are able to
                  send backup tokens to the phone numbers listed below.{% endblocktrans %}</p>
                <ul>
                  {% for phone in backup_phones %}
                    <li>
                      {{ phone.generate_challenge_button_title }}
                      <form method="post" action="{% url 'two_factor:phone_delete' phone.id %}"
                            onsubmit="return confirm({% trans 'Are you sure?' %})">
                        {% csrf_token %}
                        <button class="btn btn-sm btn-warning"
                                type="submit">{% trans "Unregister" %}</button>
                      </form>
                    </li>
                  {% endfor %}
                </ul>
                <p><a href="{% url 'two_factor:phone_create' %}"
                  class="btn btn-info">{% trans "Add Phone Number" %}</a></p>
              {% endif %}
          
              <h2>{% trans "Backup Tokens" %}</h2>
              <p>
                {% blocktrans trimmed %}If you don't have any device with you, you can access
                  your account using backup tokens.{% endblocktrans %}
                {% blocktrans trimmed count counter=backup_tokens %}
                  You have only one backup token remaining.
                {% plural %}
                  You have {{ counter }} backup tokens remaining.
                {% endblocktrans %}
              </p>
              <p><a href="{% url 'two_factor:backup_tokens' %}"
                    class="btn btn-info">{% trans "Show Codes" %}</a></p>
          
              <h3>{% trans "Disable Two-Factor Authentication" %}</h3>
              <p>{% blocktrans trimmed %}However we strongly discourage you to do so, you can
                also disable two-factor authentication for your account.{% endblocktrans %}</p>
              <p><a class="btn btn-secondary" href="{% url 'two_factor:disable' %}">
                {% trans "Disable Two-Factor Authentication" %}</a></p>
            {% else %}
            <div class="alert alert-danger" role="alert">
							Security alert !!!<a href="#!" class="alert-link">
                <p>{% blocktrans trimmed %}Two-factor authentication is not enabled for your
                  account. Enable two-factor authentication for enhanced account
                  security.{% endblocktrans %}</p>
						</div>
              <p><a href="{% url 'two_factor:setup' %}" class="btn btn-primary">
                {% trans "Enable Two-Factor Authentication" %}</a>
              </p>
            {% endif %}
          </div>
      </div>
  </div>
  <!-- [ horizontal-layout ] end -->
  

  </div>
  </div>
{% endblock %}
